<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="./menu.css" />


  <title>Snake game</title>
</head>

<body>
  <div class="score">Score: <span>0</span> build: 6</div>
  <div class="debug">Debug: <span>-</span></div>
  <div class="grid"></div>
</body>

<script src="./libs/Tone.min.14.8.49.js"></script>
<script src="./js/sketches/snake/Cell.js"></script>
<script src="./js/sketches/snake/SnakeSketch.js"></script>
<script src="./js/sketches/snake/Grid.js"></script>
<script src="./js/Sound.js"></script>
<script src="./js/sketches/snake/Snake.js"></script>
<script src="./js/sketches/snake/Food.js"></script>
<script src="./js/InputHandler.js"></script>
<script src="./js/sketches/snake/SnakeDirection.js"></script>

<script src="./js/Menu.js"></script>

<script src="./js/state-machine/AppState.js"></script>
<script src="./js/state-machine/AppStateMachine.js"></script>

<script src="./js/sketches/snake/states/SnakeSketchPlayingState.js"></script>
<script src="./js/sketches/snake/states/SnakeSketchOptionsState.js"></script>
<script src="./js/sketches/snake/states/SnakeSketchGameOverState.js"></script>
<script src="./js/sketches/snake/states/SnakeSketchPausedState.js"></script>
<script src="./js/sketches/snake/states/SnakeSketchMainMenuState.js"></script>
<script src="./js/sketches/snake/states/SnakeSketchSplashScreenState.js"></script>
<script src="./js/sketches/snake/preload-emoji-svgs.js"></script>


<script>

  const gameStateMachine = new AppStateMachine();

  // Define transitions
  // gameStateMachine.addTransition(SnakeSketchSplashScreenState, SnakeSketchMainMenuState);
  //gameStateMachine.addTransition(SnakeSketchMainMenuState, SnakeSketchOptionsState);
  gameStateMachine.addTransition(SnakeSketchMainMenuState, SnakeSketchPlayingState);
  gameStateMachine.addTransition(SnakeSketchPlayingState, SnakeSketchPausedState);
  gameStateMachine.addTransition(SnakeSketchPlayingState, SnakeSketchGameOverState);
  gameStateMachine.addTransition(SnakeSketchPausedState, SnakeSketchPlayingState);
  gameStateMachine.addTransition(SnakeSketchPausedState, SnakeSketchMainMenuState);
  gameStateMachine.addTransition(SnakeSketchGameOverState, SnakeSketchMainMenuState);


  // Define the dimensions and cell size for the grid
  const gridWidth = 25;
  const gridHeight = 20;
  const cellSize = 20;
  const initialInterval = 200;

  // Create the SnakeSketch instance
  const game = new SnakeSketch(gridWidth, gridHeight, cellSize, initialInterval);

  // add to the debug div that we are starting the game
  document.querySelector('.debug span').textContent = 'Starting the game...';

  gameStateMachine.changeState(SnakeSketchMainMenuState);


  navigator.getBattery().then((battery) => {
    // update the level info immediately
    updateLevelInfo();

    // ... and then again whenever the level changes
    battery.addEventListener("levelchange", () => {
      updateLevelInfo();
    });
    
    function updateLevelInfo() {
      document.querySelector('.debug span').textContent = `Battery level: ${battery.level * 100}%`;
    }

  });


</script>

</html>